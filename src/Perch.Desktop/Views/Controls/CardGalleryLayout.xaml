<UserControl x:Class="Perch.Desktop.Views.Controls.CardGalleryLayout"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    x:Name="Root"
    Foreground="White">

    <Grid Margin="24,16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header: page-specific content -->
        <ContentPresenter Grid.Row="0"
            Content="{Binding HeaderContent, ElementName=Root}" />

        <!-- Loading spinner -->
        <ui:ProgressRing Grid.Row="1"
            IsIndeterminate="True" Width="32" Height="32"
            HorizontalAlignment="Center" VerticalAlignment="Center"
            Visibility="{Binding IsLoading,
                Converter={StaticResource BooleanToVisibilityConverter}}" />

        <!-- Error banner -->
        <ScrollViewer Grid.Row="1" Panel.ZIndex="10" Margin="0,16,0,0"
            VerticalScrollBarVisibility="Auto"
            HorizontalScrollBarVisibility="Disabled"
            Visibility="{Binding ErrorMessage,
                Converter={StaticResource CountToVisibilityConverter}}">
            <Border Background="{StaticResource ErrorBannerBgBrush}" CornerRadius="8" Padding="16">
                <StackPanel HorizontalAlignment="Center" MaxWidth="500">
                    <Image Source="/Assets/wizard-error.png" Width="640" Height="640"
                           Margin="0,0,0,16" Stretch="Uniform"
                           HorizontalAlignment="Center" />
                    <TextBlock
                        Text="{Binding ErrorTitle, ElementName=Root}"
                        FontSize="16" FontWeight="SemiBold"
                        Foreground="{StaticResource ErrorBrush}" HorizontalAlignment="Center"
                        Margin="0,0,0,8" />
                    <TextBox Text="{Binding ErrorMessage, Mode=OneWay}"
                             IsReadOnly="True" Foreground="{StaticResource ErrorDarkBrush}" FontSize="12"
                             Background="Transparent" BorderThickness="0"
                             TextWrapping="Wrap" Margin="0" Focusable="True"
                             IsHitTestVisible="True"
                             VerticalScrollBarVisibility="Hidden"
                             HorizontalAlignment="Center" />
                </StackPanel>
            </Border>
        </ScrollViewer>

        <!-- Grid content: page-specific, visible when no detail selected -->
        <ContentPresenter Grid.Row="1" Margin="0,16,0,0"
            Content="{Binding GridContent, ElementName=Root}"
            Visibility="{Binding ShowGrid,
                Converter={StaticResource BooleanToVisibilityConverter}}" />

        <!-- Detail content: page-specific, visible when detail selected -->
        <ContentPresenter Grid.Row="1" Margin="0,16,0,0"
            Content="{Binding DetailContent, ElementName=Root}"
            Visibility="{Binding ShowDetail,
                Converter={StaticResource BooleanToVisibilityConverter}}" />
    </Grid>
</UserControl>
